# [Moloch](https://github.com/aol/moloch) Docker image/container

This repository contains the files to build a Docker image of the Moloch software:

**http://molo.ch/**

Ready to use Docker images can be pulled from https://hub.docker.com/r/mammo0/docker-moloch

To run this image a working Elasticsearch environment is required. Please stick to their documentation for setting this up. (E.g. for docker: https://www.elastic.co/guide/en/elasticsearch/reference/current/docker.html)



### Run the container
This image can be run with

```shell
docker run \
    -e ES_HOST=elasticsearch \
    -e ES_PORT 9200 \
    -v <config_volume>:/data/config \
    -v <pcap_volume>:/data/pcap \
    -v <log_volume>:/data/logs \
    mammo0/docker-moloch:<tag>
```

These parameters are available:


| ENV VARIABLE | DEFAULT VALUE |  NOTES |
| - | - | - |
| ES_HOST | elasticsearch | The hostname or IP address where Elasticsearch is running.  |
| ES_PORT | 9200 | The port where Elasticsearch is reachable. |
| MOLOCH_PASSWORD | admin | This is the password for the Moloch admin user that is needed for the first login. It can be changed afterwards. |
| MOLOCH_INTERFACE | eth0 | Network interface where `moloch-capture` process listens. **This feature is not tested yet!** |
| MOLOCH_HOSTNAME | localhost | With this hostname Moloch authenticates at Elasticsearch. So if you change this you'll lose your Elasticsearch configuration. |
| CAPTURE | off | Set to "on" to activate the `moloch-capture` process. **This feature is not tested yet!** |
| VIEWER | on | Set to "off" to deactivate the Moloch viewer. |

| VOLUME | CONTAINER PATH | NOTES |
| - | - | - |
| config_volume | /data/config | In this directory the Moloch configuration is saved. |
| pcap_volume | /data/pcap | In this directory the pcap files are saved that are generated by `moloch-capture`. |
| log_volume | /data/logs | In this directory the Moloch log files are saved. |



#### Import pcap files
To import existing pcap files have a look at `scripts/moloch-parse-pcap-folder.sh` script. It can be run within the running container:

```shell
docker exec -it <container_name> bash
    # then in the container shell:
    ~> /data/moloch-parse-pcap-folder.sh -d <directory_with_pcap_files> -t <tag>
```
